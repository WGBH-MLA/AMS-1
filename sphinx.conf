#
# Minimal Sphinx configuration sample (clean, simple, functional)
#

source stations_src
{
	type= mysql
	sql_host= localhost
	sql_user= root
	sql_pass= pl@123
	sql_db	= ams
	sql_port= 3306	# optional, default is 3306
	sql_query_pre = SET NAMES utf8
	sql_query_pre = SET SESSION query_cache_type=OFF
	sql_query_range = SELECT MIN(id),MAX(id) FROM stations
	sql_range_step = 1000
	
	
	sql_query= SELECT id,cpb_id,station_name,address_primary,\
	address_secondary,city,state,zip,\
	CASE WHEN `type`=0 THEN 'Radio' WHEN `type`=1 THEN 'TV' WHEN `type`=2 THEN 'Joint' END AS my_type,\
	allocated_hours,allocated_buffer,total_allocated,is_certified,is_agreed,IFNULL(UNIX_TIMESTAMP(start_date),0) AS start_date,\
	IFNULL(UNIX_TIMESTAMP(end_date),0) AS end_date FROM stations WHERE id>=$start AND id<=$end
	
	sql_attr_uint=cpb_id
	sql_field_string = station_name 
	sql_field_string = my_type
	sql_field_string = address_primary
	sql_field_string = address_secondary
	
	sql_field_string = city
	sql_field_string = state
	sql_field_string = zip
	sql_attr_uint=allocated_hours
	sql_attr_uint=allocated_buffer
	sql_attr_uint=total_allocated
	sql_attr_uint=is_certified
	sql_attr_uint=is_agreed
	sql_attr_uint=start_date
	sql_attr_uint=end_date

}
index stations
{
	source					= stations_src
	path					= /var/lib/sphinx/stations_src
	docinfo					= extern
	charset_type			= sbcs
}

source asset_details_src
{
	type= mysql
	sql_host= localhost
	sql_user= root
	sql_pass= pl@123
	sql_db	= ams
	sql_port= 3306	# optional, default is 3306
	sql_query_pre = SET NAMES utf8
	sql_query_pre = SET SESSION query_cache_type=OFF
	
	 		
	sql_query=SELECT assets.id,IFNULL(identifiers.identifier,'') AS guid_identifier, stations.station_name as organization, \
				GROUP_CONCAT(local.identifier SEPARATOR ' | ') AS local_identifier, \
				GROUP_CONCAT(local.identifier_source SEPARATOR ' | ') AS local_identifier_source, \
				GROUP_CONCAT(local.identifier_ref SEPARATOR ' | ') AS local_identifier_ref, asset_descriptions.description, \
				asset_titles.title , asset_titles.title_source ,asset_titles.title_ref ,asset_title_types.title_type, \
				GROUP_CONCAT(asset_types.asset_type SEPARATOR ' | ') AS asset_type \
				FROM (`assets`) \
				LEFT JOIN identifiers AS `local` ON `local`.`assets_id` = `assets`.`id` \
				LEFT JOIN identifiers ON `identifiers`.`assets_id` = `assets`.`id` \
				LEFT JOIN asset_descriptions ON `asset_descriptions`.`assets_id` = `assets`.`id` \
				LEFT JOIN asset_titles ON `asset_titles`.`assets_id` = `assets`.`id` \
				LEFT JOIN asset_title_types ON `asset_title_types`.`id` = `asset_titles`.`asset_title_types_id` \
				LEFT JOIN stations ON stations.id = assets.stations_id \
				LEFT JOIN assets_asset_types ON assets_asset_types.assets_id = `assets`.`id` \
				LEFT JOIN asset_types ON assets_asset_types.asset_types_id = asset_types.`id` \
				WHERE `identifiers`.`identifier_source` = 'http://americanarchiveinventory.org'  \
				AND `local`.`identifier_source` != 'http://americanarchiveinventory.org' \
				GROUP BY `assets`.`id` 
				
	sql_field_string = guid_identifier
	sql_field_string = local_identifier
	sql_field_string = description
	sql_field_string = title
	sql_field_string = organization
	sql_field_string = local_identifier_source
	sql_field_string = local_identifier_ref
	sql_field_string = title_source
	sql_field_string = title_ref
	sql_field_string = title_type
	sql_field_string = asset_type
	
}


index asset_details
{
	source					= asset_details_src
	path					= /var/lib/sphinx/asset_details_src
	docinfo					= extern
	charset_type			= sbcs
}
source assets_subjects_src
{
	type= mysql
	sql_host= localhost
	sql_user= root
	sql_pass= pl@123
	sql_db	= ams
	sql_port= 3306	# optional, default is 3306
	sql_query_pre = SET NAMES utf8
	sql_query_pre = SET SESSION query_cache_type=OFF
	
	 		
	sql_query= SELECT subjects.id as id,assets_subjects.assets_id as assets_id, `subject`, `subject_source`, `subject_ref` FROM (`assets_subjects`) \
				LEFT JOIN `subjects` ON `assets_subjects`.`subjects_id`=`subjects`.`id`  
	sql_attr_uint    = assets_id	
	sql_field_string = subject
	sql_field_string = subject_source
	sql_field_string = subject_ref
	
}


index assets_subjects
{
	source					= assets_subjects_src
	path					= /var/lib/sphinx/assets_subjects_src
	docinfo					= extern
	charset_type			= sbcs
}
source asset_dates_src
{
	type= mysql
	sql_host= localhost
	sql_user= root
	sql_pass= pl@123
	sql_db	= ams
	sql_port= 3306	# optional, default is 3306
	sql_query_pre = SET NAMES utf8
	sql_query_pre = SET SESSION query_cache_type=OFF
	
	 		
	sql_query= SELECT asset_dates.id ,asset_dates.assets_id as assets_id, IFNULL(UNIX_TIMESTAMP(`asset_dates`.`asset_date`),0) AS asset_date , `date_types`.`date_type` FROM (`asset_dates`) \
					LEFT JOIN `date_types` ON `asset_dates`.`date_types_id`=`date_types`.`id`  
	sql_attr_uint    = assets_id
	sql_attr_uint    = asset_date	
	sql_field_string = date_type
	
}


index asset_dates
{
	source					= asset_dates_src
	path					= /var/lib/sphinx/asset_dates_src
	docinfo					= extern
	charset_type			= sbcs
}

source assets_genres_src
{
	type= mysql
	sql_host= localhost
	sql_user= root
	sql_pass= pl@123
	sql_db	= ams
	sql_port= 3306	# optional, default is 3306
	sql_query_pre = SET NAMES utf8
	sql_query_pre = SET SESSION query_cache_type=OFF
	
	 		
	sql_query= SELECT `genres`.`id`,`assets_genres`.`assets_id` ,`genre`, `genre_source`, `genre_ref` FROM (`assets_genres`) \
					LEFT JOIN `genres` ON `assets_genres`.`genres_id`=`genres`.`id`
	sql_attr_uint    = assets_id
	sql_field_string = genre
	sql_field_string = genre_source
	sql_field_string = genre_ref
	
}

index assets_genres
{
	source					= assets_genres_src
	path					= /var/lib/sphinx/assets_genres_src
	docinfo					= extern
	charset_type			= sbcs
}


source assets_creators_roles_src
{
	type= mysql
	sql_host= localhost
	sql_user= root
	sql_pass= pl@123
	sql_db	= ams
	sql_port= 3306	# optional, default is 3306
	sql_query_pre = SET NAMES utf8
	sql_query_pre = SET SESSION query_cache_type=OFF
	
	 		
	sql_query= SELECT `creators`.`id`,`assets_creators_roles`.`assets_id`,`creator_name`, `creator_affiliation`, `creator_ref`, `creator_role`,\
				`creator_role_source`, `creator_role_ref` \
				FROM (`assets_creators_roles`) \
				LEFT JOIN `creator_roles` ON `assets_creators_roles`.`creator_roles_id`=`creator_roles`.`id` \
				LEFT JOIN `creators` ON `assets_creators_roles`.`creators_id`=`creators`.`id`
	sql_attr_uint    = assets_id
	sql_field_string = creator_name
	sql_field_string = creator_affiliation
	sql_field_string = creator_ref
	sql_field_string = creator_role
	sql_field_string = creator_role_source
	sql_field_string = creator_role_ref
	
}

index assets_creators_roles
{
	source					= assets_creators_roles_src
	path					= /var/lib/sphinx/assets_creators_roles_src
	docinfo					= extern
	charset_type			= sbcs
}

 



source assets_publishers_role_src
{
	type= mysql
	sql_host= localhost
	sql_user= root
	sql_pass= pl@123
	sql_db	= ams
	sql_port= 3306	# optional, default is 3306
	sql_query_pre = SET NAMES utf8
	sql_query_pre = SET SESSION query_cache_type=OFF
	
	 		
	sql_query= SELECT `publisher_roles`.`id`,`assets_publishers_role`.`assets_id`,`publisher_role`, `publisher_role_source`, `publisher_role_ref`, `publisher`, `publisher_affiliation`, `publisher_ref` \
				FROM (`assets_publishers_role`) \
				LEFT JOIN `publisher_roles` ON `assets_publishers_role`.`publisher_roles_id`=`publisher_roles`.`id` \
				LEFT JOIN `publishers` ON `assets_publishers_role`.`publishers_id`=`publishers`.`id`
	sql_attr_uint    = assets_id
	sql_field_string = publisher_role
	sql_field_string = publisher_role_source
	sql_field_string = publisher_role_ref
	sql_field_string = publisher
	sql_field_string = publisher_affiliation
	sql_field_string = publisher_ref
	
}

index assets_publishers_role
{
	source					= assets_publishers_role_src
	path					= /var/lib/sphinx/assets_publishers_role_src
	docinfo					= extern
	charset_type			= sbcs
}
 
source coverages_src
{
	type= mysql
	sql_host= localhost
	sql_user= root
	sql_pass= pl@123
	sql_db	= ams
	sql_port= 3306	# optional, default is 3306
	sql_query_pre = SET NAMES utf8
	sql_query_pre = SET SESSION query_cache_type=OFF
	
			
	sql_query=  SELECT  id ,assets_id ,	coverage ,coverage_type  FROM (`coverages`)
	sql_attr_uint    = assets_id
	sql_field_string = coverage
	sql_field_string = coverage_type

}

index coverages
{
	source					= coverages_src
	path					= /var/lib/sphinx/coverages_src
	docinfo					= extern
	charset_type			= sbcs
}

source annotations_src
{
	type= mysql
	sql_host= localhost
	sql_user= root
	sql_pass= pl@123
	sql_db	= ams
	sql_port= 3306	# optional, default is 3306
	sql_query_pre = SET NAMES utf8
	sql_query_pre = SET SESSION query_cache_type=OFF
	
			
	sql_query=  SELECT  id ,assets_id ,annotation,annotation_type,annotation_ref FROM (`annotations`)
	sql_attr_uint    = assets_id
	sql_field_string = annotation
	sql_field_string = annotation_type
	sql_field_string = annotation_ref

}

index annotations
{
	source					= annotations_src
	path					= /var/lib/sphinx/annotations_src
	docinfo					= extern
	charset_type			= sbcs
}
source rights_summaries_src
{
	type= mysql
	sql_host= localhost
	sql_user= root
	sql_pass= pl@123
	sql_db	= ams
	sql_port= 3306	# optional, default is 3306
	sql_query_pre = SET NAMES utf8
	sql_query_pre = SET SESSION query_cache_type=OFF
	
			
	sql_query=  SELECT  id ,	assets_id ,	rights ,	rights_link  FROM (`rights_summaries`)
	sql_attr_uint    = assets_id
	sql_field_string = rights
	sql_field_string = rights_link

}

index rights_summaries
{
	source					= rights_summaries_src
	path					= /var/lib/sphinx/rights_summaries_src
	docinfo					= extern
	charset_type			= sbcs
}
source assets_audience_ratings_src
{
	type= mysql
	sql_host= localhost
	sql_user= root
	sql_pass= pl@123
	sql_db	= ams
	sql_port= 3306	# optional, default is 3306
	sql_query_pre = SET NAMES utf8
	sql_query_pre = SET SESSION query_cache_type=OFF
	
	 		
	sql_query= SELECT `audience_ratings`.`id` ,`assets_audience_ratings`.`assets_id`,`audience_rating`, `audience_rating_source`, `audience_rating_ref` \
				FROM (`assets_audience_ratings`) \
				LEFT JOIN `audience_ratings` ON `assets_audience_ratings`.`audience_ratings_id`=`audience_ratings`.`id`
	sql_attr_uint    = assets_id
	sql_field_string = audience_rating
	sql_field_string = audience_rating_source
	sql_field_string = audience_rating_ref

}

index assets_audience_ratings
{
	source					= assets_audience_ratings_src
	path					= /var/lib/sphinx/assets_audience_ratings_src
	docinfo					= extern
	charset_type			= sbcs
}

source assets_audience_levels_src
{
	type= mysql
	sql_host= localhost
	sql_user= root
	sql_pass= pl@123
	sql_db	= ams
	sql_port= 3306	# optional, default is 3306
	sql_query_pre = SET NAMES utf8
	sql_query_pre = SET SESSION query_cache_type=OFF
	
	 		
	sql_query= SELECT `audience_levels`.`id` ,`assets_audience_levels`.`assets_id`,`audience_level`, `audience_level_source`, `audience_level_ref` \
				FROM (`assets_audience_levels`) \
				LEFT JOIN `audience_levels` ON `assets_audience_levels`.`audience_levels_id`=`audience_levels`.`id`
	sql_attr_uint    = assets_id
	sql_field_string = audience_level
	sql_field_string = audience_level_source
	sql_field_string = audience_level_ref

}

index assets_audience_levels
{
	source					= assets_audience_levels_src
	path					= /var/lib/sphinx/assets_audience_levels_src
	docinfo					= extern
	charset_type			= sbcs
}
 
 
source assets_contributors_roles_src
{
	type= mysql
	sql_host= localhost
	sql_user= root
	sql_pass= pl@123
	sql_db	= ams
	sql_port= 3306	# optional, default is 3306
	sql_query_pre = SET NAMES utf8
	sql_query_pre = SET SESSION query_cache_type=OFF
	
	 		
	sql_query= SELECT `contributors`.`id`,`assets_contributors_roles`.`assets_id`,`contributor_role`, `contributor_role_source`, `contributor_role_ref`, \
				`contributor_name`, `contributor_affiliation`, `contributor_source`, `contributor_ref` \
				FROM (`assets_contributors_roles`) \
				LEFT JOIN `contributor_roles` ON `assets_contributors_roles`.`contributor_roles_id`=`contributor_roles`.`id` \
				LEFT JOIN `contributors` ON `assets_contributors_roles`.`contributors_id`=`contributors`.`id`
	sql_attr_uint    = assets_id
	sql_field_string = contributor_role
	sql_field_string = contributor_role_source
	sql_field_string = contributor_role_ref
	sql_field_string = contributor_name
	sql_field_string = contributor_affiliation
	sql_field_string = contributor_source
	sql_field_string = contributor_ref
	
}

index assets_contributors_roles
{
	source					= assets_contributors_roles_src
	path					= /var/lib/sphinx/assets_contributors_roles_src
	docinfo					= extern
	charset_type			= sbcs
}
source instantiations_list_src
{
	type= mysql
	sql_host= localhost
	sql_user= root
	sql_pass= pl@123
	sql_db	= ams
	sql_port= 3306	# optional, default is 3306
	sql_query_pre = SET NAMES utf8
	sql_query_pre = SET SESSION query_cache_type=OFF
	
	 		
	sql_query= SELECT instantiations.id ,instantiations.assets_id ,IFNULL(instantiations.language,'') as language, \
					IFNULL(TIME_TO_SEC(instantiations.actual_duration),0) AS actual_duration, \
					IFNULL(TIME_TO_SEC(instantiations.projected_duration),0) AS projected_duration, \
					instantiations.file_size_unit_of_measure,instantiations.file_size, \
					GROUP_CONCAT(asset_titles.title SEPARATOR ' | ') as multi_assets, \
					stations.station_name AS organization, \
					IFNULL(UNIX_TIMESTAMP(instantiation_dates.instantiation_date ),0) as  instantiation_date, \
					date_types.date_type,instantiation_media_types.media_type, instantiation_formats.format_type, \
					instantiation_formats.format_name, instantiation_colors.color, `generations`.`generation` AS generation, nomination_status.status, \
					CASE WHEN events.event_outcome=0 THEN 'FAIL' WHEN events.event_outcome=1 THEN 'PASS' END AS outcome_event, event_types.event_type, \
					instantiation_identifier.instantiation_identifier,instantiation_identifier.instantiation_source \
           FROM (`instantiations`) \
					LEFT JOIN `assets` ON `assets`.`id` = `instantiations`.`assets_id`  \
					LEFT JOIN `asset_titles` ON `asset_titles`.`assets_id` = `instantiations`.`assets_id` \
					JOIN `stations` ON `stations`.`id` = `assets`.`stations_id` \
					LEFT JOIN `instantiation_dates` ON `instantiation_dates`.`instantiations_id` = `instantiations`.`id` \
					LEFT JOIN `date_types` ON `date_types`.`id` = `instantiation_dates`.`date_types_id` \
					LEFT JOIN `instantiation_media_types` ON `instantiation_media_types`.`id` = `instantiations`.`instantiation_media_type_id` \
					LEFT JOIN `instantiation_formats` ON `instantiation_formats`.`instantiations_id` = `instantiations`.`id` \
					LEFT JOIN `instantiation_colors` ON `instantiation_colors`.`id` = `instantiations`.`instantiation_colors_id` \
					LEFT JOIN `instantiation_identifier` ON `instantiations`.`id` = `instantiation_identifier`.`id` \
					LEFT JOIN `instantiation_generations` ON `instantiation_generations`.`instantiations_id` = `instantiations`.`id`\
					LEFT JOIN `generations` ON `generations`.`id` = `instantiation_generations`.`generations_id`\
					LEFT JOIN `nominations` ON `nominations`.`instantiations_id` = `instantiations`.`id`\
					LEFT JOIN `nomination_status` ON `nomination_status`.`id` = `nominations`.`nomination_status_id`\
					LEFT JOIN `events` ON `events`.`instantiations_id`       = `instantiations`.`id`\
					LEFT JOIN `event_types` ON `event_types`.`id`    = `events`.`event_types_id`\
                GROUP BY `instantiations`.`id`
        sql_attr_uint    = assets_id
        sql_field_string = language
        sql_field_string = file_size_unit_of_measure
        sql_field_string = multi_assets
        sql_field_string = organization
        sql_field_string = instantiation_date
        sql_field_string = date_type
        sql_field_string = media_type
        sql_field_string = format_type
        sql_field_string = color
        sql_field_string = actual_duration
        sql_field_string = projected_duration
        sql_field_string = file_size
        sql_field_string = format_name
        sql_field_string = generation
        sql_field_string = status
        sql_field_string = outcome_event
        sql_field_string = event_type	
		sql_field_string = instantiation_identifier
		sql_field_string = instantiation_source
	
	
	
}


index instantiations_list
{
	source					= instantiations_list_src
	path					= /var/lib/sphinx/instantiations_list_src
	docinfo					= extern
	charset_type			= sbcs
}
  

source assets_list_src
{
	type= mysql
	sql_host= localhost
	sql_user= root
	sql_pass= pl@123
	sql_db	= ams
	sql_port= 3306	# optional, default is 3306
	sql_query_pre = SET NAMES utf8
	sql_query_pre = SET SESSION query_cache_type=OFF	 		
	sql_query =SELECT `assets`.`id`, `identifiers`.`identifier` AS guid_identifier, `asset_descriptions`.`description`, \
				IFNULL(`description_types`.`description_type`,'N/A') AS description_type, \
				GROUP_CONCAT(IFNULL(`local`.`identifier`,'N/A') SEPARATOR ' | ') AS local_identifier, \
				GROUP_CONCAT(IFNULL(`asset_titles`.`title`,'N/A') SEPARATOR ' | ') AS asset_title, \
				GROUP_CONCAT(IFNULL(`asset_titles`.`title_source`,'N/A') SEPARATOR ' | ') AS asset_title_source, \
				GROUP_CONCAT(IFNULL(`asset_titles`.`title_ref`,'N/A') SEPARATOR ' | ') AS asset_title_ref, \
				GROUP_CONCAT(IFNULL(`asset_title_types`.`title_type`,'N/A') SEPARATOR ' | ') AS asset_title_type, \
				GROUP_CONCAT(IFNULL(`subjects`.`subject`,'N/A') SEPARATOR ' | ') AS asset_subject, \
				GROUP_CONCAT(IFNULL(`subjects`.subject_source,'N/A') SEPARATOR ' | ') AS asset_subject_source, \
				GROUP_CONCAT(IFNULL(`subjects`.subject_ref,'N/A') SEPARATOR ' | ') AS asset_subject_ref, \
				GROUP_CONCAT(IFNULL(`genres`.`genre`,'N/A') SEPARATOR ' | ') AS asset_genre, \
				GROUP_CONCAT(IFNULL(`genres`.`genre_source`,'N/A') SEPARATOR ' | ') AS asset_genre_source, \
				GROUP_CONCAT(IFNULL(`genres`.`genre_ref`,'N/A') SEPARATOR ' | ') AS asset_genre_ref, \
				GROUP_CONCAT(IFNULL(`creators`.`creator_name`,'N/A') SEPARATOR ' | ') AS asset_creator_name, \
				GROUP_CONCAT(IFNULL(`creators`.`creator_affiliation`,'N/A') SEPARATOR ' | ') AS asset_creator_affiliation, \
				GROUP_CONCAT(IFNULL(`creators`.`creator_source`,'N/A') SEPARATOR ' | ') AS asset_creator_source, \
				GROUP_CONCAT(IFNULL(`creators`.`creator_ref`,'N/A') SEPARATOR ' | ') AS asset_creator_ref, \
				GROUP_CONCAT(IFNULL(`creator_roles`.`creator_role`,'N/A') SEPARATOR ' | ') AS asset_creator_role, \
				GROUP_CONCAT(IFNULL(`creator_roles`.`creator_role_source`,'N/A') SEPARATOR ' | ') AS asset_creator_role_source, \
				GROUP_CONCAT(IFNULL(`creator_roles`.`creator_role_ref`,'N/A') SEPARATOR ' | ') AS asset_creator_role_ref, \
				GROUP_CONCAT(IFNULL(`contributors`.`contributor_name`,'N/A') SEPARATOR ' | ') AS asset_contributor_name, \
				GROUP_CONCAT(IFNULL(`contributors`.`contributor_affiliation`,'N/A') SEPARATOR ' | ') AS asset_contributor_affiliation, \
				GROUP_CONCAT(IFNULL(`contributors`.`contributor_source`,'N/A') SEPARATOR ' | ') AS asset_contributor_source, \
				GROUP_CONCAT(IFNULL(`contributors`.`contributor_ref`,'N/A') SEPARATOR ' | ') AS asset_contributor_ref, \
				GROUP_CONCAT(IFNULL(`contributor_roles`.`contributor_role`,'N/A') SEPARATOR ' | ') AS asset_contributor_role, \
				GROUP_CONCAT(IFNULL(`contributor_roles`.`contributor_role_source`,'N/A') SEPARATOR ' | ') AS asset_contributor_role_source, \
				GROUP_CONCAT(IFNULL(`contributor_roles`.`contributor_role_ref`,'N/A') SEPARATOR ' | ') AS asset_contributor_role_ref, \
				GROUP_CONCAT(IFNULL(`publishers`.`publisher`,'N/A') SEPARATOR ' | ') AS asset_publisher_name, \
				GROUP_CONCAT(IFNULL(`publishers`.`publisher_affiliation`,'N/A') SEPARATOR ' | ') AS asset_publisher_affiliation, \
				GROUP_CONCAT(IFNULL(`publishers`.`publisher_ref`,'N/A') SEPARATOR ' | ') AS asset_publisher_ref, \
				GROUP_CONCAT(IFNULL(`publisher_roles`.`publisher_role`,'N/A') SEPARATOR ' | ') AS asset_publisher_role, \
				GROUP_CONCAT(IFNULL(`publisher_roles`.`publisher_role_source`,'N/A') SEPARATOR ' | ') AS asset_publisher_role_source, \
				GROUP_CONCAT(IFNULL(`publisher_roles`.`publisher_role_ref`,'N/A') SEPARATOR ' | ') AS asset_publisher_role_ref, \
				GROUP_CONCAT(IFNULL(UNIX_TIMESTAMP(`asset_dates`.`asset_date`),0) SEPARATOR ' | ') AS asset_date, \
				GROUP_CONCAT(IFNULL(`date_types`.`date_type`,'N/A') SEPARATOR ' | ') AS asset_date_type, \
				GROUP_CONCAT(IFNULL(`coverages`.`coverage`,'N/A') SEPARATOR ' | ') AS asset_coverage, \
				GROUP_CONCAT(IFNULL(`coverages`.`coverage_type`,'N/A') SEPARATOR ' | ') AS asset_coverage_type, \
				GROUP_CONCAT(IFNULL(`audience_levels`.`audience_level`,'N/A') SEPARATOR ' | ') AS asset_audience_level, \
				GROUP_CONCAT(IFNULL(`audience_levels`.`audience_level_source`,'N/A') SEPARATOR ' | ') AS asset_audience_level_source, \
				GROUP_CONCAT(IFNULL(`audience_levels`.`audience_level_ref`,'N/A') SEPARATOR ' | ') AS asset_audience_level_ref, \
				GROUP_CONCAT(IFNULL(`audience_ratings`.`audience_rating`,'N/A') SEPARATOR ' | ') AS asset_audience_rating, \
				GROUP_CONCAT(IFNULL(`audience_ratings`.`audience_rating_source`,'N/A') SEPARATOR ' | ') AS asset_audience_rating_source, \
				GROUP_CONCAT(IFNULL(`audience_ratings`.`audience_rating_ref`,'N/A') SEPARATOR ' | ') AS asset_audience_rating_ref, \
				GROUP_CONCAT(IFNULL(`annotations`.`annotation`,'N/A') SEPARATOR ' | ') AS asset_annotation, \
				GROUP_CONCAT(IFNULL(`annotations`.`annotation_type`,'N/A') SEPARATOR ' | ') AS asset_annotation_type, \
				GROUP_CONCAT(IFNULL(`annotations`.`annotation_ref`,'N/A') SEPARATOR ' | ') AS asset_annotation_ref, \
				GROUP_CONCAT(IFNULL(`rights_summaries`.`rights`,'N/A') SEPARATOR ' | ') AS asset_rights, \
				GROUP_CONCAT(IFNULL(`rights_summaries`.`rights_link`,'N/A') SEPARATOR ' | ') AS asset_rights_link \
				FROM (`assets`) \
				LEFT JOIN `identifiers` AS `local` ON `local`.`assets_id` = `assets`.`id` LEFT JOIN `identifiers` ON `identifiers`.`assets_id` = `assets`.`id` \
				LEFT JOIN `asset_descriptions` ON `asset_descriptions`.`assets_id` = `assets`.`id` \
				LEFT JOIN `description_types` ON `description_types`.`id` = `asset_descriptions`.`description_types_id` \
				LEFT JOIN `asset_titles` ON `asset_titles`.`assets_id` = `assets`.`id` \
				LEFT JOIN `asset_title_types` ON `asset_titles`.`asset_title_types_id` = `asset_title_types`.`id` \
				LEFT JOIN `assets_subjects` ON `assets_subjects`.`assets_id` = `assets`.`id` LEFT JOIN `subjects` ON `subjects`.`id` = `assets_subjects`.`subjects_id` LEFT JOIN `assets_genres` ON `assets_genres`.`assets_id` = `assets`.`id` LEFT JOIN `genres` ON `genres`.`id` = `assets_genres`.`genres_id` = `assets`.`id` LEFT JOIN `assets_creators_roles` ON `assets_creators_roles`.`assets_id`=`assets`.`id` LEFT JOIN `creator_roles` ON `assets_creators_roles`.`creator_roles_id`=`creator_roles`.`id` LEFT JOIN `creators` ON `assets_creators_roles`.`creators_id`=`creators`.`id` \
				LEFT JOIN `assets_contributors_roles` ON `assets_contributors_roles`.`assets_id`=`assets`.`id` \
				LEFT JOIN `contributor_roles` ON `assets_contributors_roles`.`contributor_roles_id`=`contributor_roles`.`id` \
				LEFT JOIN `contributors` ON `assets_contributors_roles`.`contributors_id`=`contributors`.`id` \
				LEFT JOIN `assets_publishers_role` ON `assets_publishers_role`.`assets_id`=`assets`.`id` \
				LEFT JOIN `publisher_roles` ON `assets_publishers_role`.`publisher_roles_id`=`publisher_roles`.`id` \
				LEFT JOIN `publishers` ON `assets_publishers_role`.`publishers_id`=`publishers`.`id` \
				LEFT JOIN `asset_dates` ON `asset_dates`.`assets_id`=`assets`.`id` \
				LEFT JOIN `date_types` ON `asset_dates`.`date_types_id`=`date_types`.`id` \
				LEFT JOIN `coverages` ON `coverages`.`assets_id`=`assets`.`id` \
				LEFT JOIN `assets_audience_levels` ON `assets_audience_levels`.`assets_id`=`assets`.`id` \
				LEFT JOIN `audience_levels` ON `assets_audience_levels`.`audience_levels_id`=`audience_levels`.`id` \
				LEFT JOIN `assets_audience_ratings` ON `assets_audience_ratings`.`assets_id`=`assets`.`id` \
				LEFT JOIN `audience_ratings` ON `assets_audience_ratings`.`audience_ratings_id`=`audience_ratings`.`id` \
				LEFT JOIN `annotations` ON `annotations`.`assets_id`=`assets`.`id` \
				LEFT JOIN `rights_summaries` ON `rights_summaries`.`assets_id`=`assets`.`id` \
				WHERE `identifiers`.`identifier_source` = 'http://americanarchiveinventory.org' AND `local`.`identifier_source` != 'http://americanarchiveinventory.org'  \
				GROUP BY `assets`.`id` 
				
	sql_field_string = guid_identifier
	sql_field_string = description
	sql_field_string = description_type
	sql_field_string = local_identifier
	sql_field_string = asset_title
	sql_field_string = asset_title_source
	sql_field_string = asset_title_ref
	sql_field_string = asset_title_type
	sql_field_string = asset_subject
	sql_field_string = asset_subject_source
	sql_field_string = asset_subject_ref
	sql_field_string = asset_genre
	sql_field_string = asset_genre_source
	sql_field_string = asset_genre_ref
	sql_field_string = asset_creator_name
	sql_field_string = asset_creator_affiliation
	sql_field_string = asset_creator_source
	sql_field_string = asset_creator_ref
	sql_field_string = asset_creator_role
	sql_field_string = asset_creator_role_source
	sql_field_string = asset_contributor_name
	sql_field_string = asset_contributor_affiliation
	sql_field_string = asset_contributor_source
	sql_field_string = asset_contributor_ref
	sql_field_string = asset_contributor_role
	sql_field_string = asset_contributor_role_source
	sql_field_string = asset_contributor_role_ref
	sql_field_string = asset_publisher_name
	sql_field_string = asset_publisher_affiliation
	sql_field_string = asset_publisher_ref
	sql_field_string = asset_publisher_role
	sql_field_string = asset_publisher_role_source
	sql_field_string = asset_publisher_role_ref
	sql_field_string = asset_date
	sql_field_string = asset_date_type
	sql_field_string = asset_coverage
	sql_field_string = asset_coverage_type
	sql_field_string = asset_audience_level
	sql_field_string = asset_audience_level_source
	sql_field_string = asset_audience_level_ref
	sql_field_string = asset_audience_rating
	sql_field_string = asset_audience_rating_source
	sql_field_string = asset_audience_rating_ref
	sql_field_string = asset_annotation
	sql_field_string = asset_annotation_type
	sql_field_string = asset_annotation_ref
	sql_field_string = asset_rights
	sql_field_string = asset_rights_link
}
index assets_list
{
	source					= assets_list_src
	path					= /var/lib/sphinx/assets_list_src
	docinfo					= extern
	charset_type			= sbcs
}

indexer
{
	mem_limit				= 128M
}


searchd
{
    listen				= 9312
    log				    = /var/log/sphinx/searchd.log
	query_log			= /var/log/sphinx/query.log
	read_timeout		= 5
	max_children		= 30
	pid_file			= /var/run/sphinx/searchd.pid
	max_matches			= 1000
	seamless_rotate		= 1
    preopen_indexes	    = 1
	unlink_old			= 1
}
