#
# Minimal Sphinx configuration sample (clean, simple, functional)
#



source station_sample_src
{
 type= mysql
 sql_host= localhost
 sql_user= ams
 sql_pass= xoho@123
 sql_db = ams
 sql_port= 3306 # optional, default is 3306
 sql_query_pre = SET NAMES utf8
 sql_query_pre = SET SESSION query_cache_type=OFF
 
  sql_query= SELECT   id,cpb_id,station_name,address_primary,\
  address_secondary,city,state,zip,\
  CASE WHEN `type`=0 THEN 'Radio' WHEN `type`=1 THEN 'TV' WHEN `type`=2 THEN 'Joint' END AS my_type,\
  allocated_hours,allocated_buffer,total_allocated,is_certified,is_agreed,IFNULL(UNIX_TIMESTAMP(start_date),0) AS start_date,\
  IFNULL(UNIX_TIMESTAMP(end_date),0) AS end_date FROM stations
 
 sql_field_string = station_name 
 sql_field_string = my_type
 sql_field_string = address_primary
 sql_field_string = address_secondary
 sql_field_string = city
 sql_field_string = state
 sql_field_string = zip
 sql_field_string = cpb_id
 sql_attr_uint=allocated_hours
 sql_attr_uint=allocated_buffer
 sql_attr_uint=total_allocated
 sql_attr_uint=is_certified
 sql_attr_uint=is_agreed
 sql_attr_uint=start_date
 sql_attr_uint=end_date

}
index station_sample
{
 
 source  = station_sample_src
 path  = /var/lib/sphinx/station_sample_src
 docinfo  = extern
 charset_type   = sbcs
}
source stations_src
{
 type= mysql
 sql_host= localhost
 sql_user= ams
 sql_pass= xoho@123
 sql_db = ams
 sql_port= 3306 # optional, default is 3306
 sql_query_pre = SET NAMES utf8
 sql_query_pre = SET SESSION query_cache_type=OFF
 
  sql_query= SELECT   id,cpb_id,station_name,address_primary,\
  address_secondary,city,state,zip,\
  CASE WHEN `type`=0 THEN 'Radio' WHEN `type`=1 THEN 'TV' WHEN `type`=2 THEN 'Joint' END AS my_type,\
  allocated_hours,allocated_buffer,total_allocated,is_certified,is_agreed,IFNULL(UNIX_TIMESTAMP(start_date),0) AS start_date,\
  IFNULL(UNIX_TIMESTAMP(end_date),0) AS end_date FROM stations
 
 sql_field_string = station_name 
 sql_field_string = my_type
 sql_field_string = address_primary
 sql_field_string = address_secondary
 sql_field_string = city
 sql_field_string = state
 sql_field_string = zip
 sql_field_string = cpb_id
 sql_attr_uint=allocated_hours
 sql_attr_uint=allocated_buffer
 sql_attr_uint=total_allocated
 sql_attr_uint=is_certified
 sql_attr_uint=is_agreed
 sql_attr_uint=start_date
 sql_attr_uint=end_date

}
index stations
{
 source  = stations_src
 path  = /var/lib/sphinx/stations_src
 docinfo  = extern
 charset_type   = sbcs
}

source instantiations_list_src
{
 type= mysql
 sql_host= localhost
 sql_user= ams
 sql_pass= xoho@123
 sql_db = ams
 sql_port= 3306 # optional, default is 3306
 sql_query_pre = SET NAMES utf8
 sql_query_pre = SET SESSION query_cache_type=OFF
 sql_query_range = SELECT MIN(id),MAX(id) FROM instantiations
 sql_range_step = 1000
 
 
 sql_query= SELECT  instantiations.id, instantiations.assets_id, `identifiers`.`identifier` AS guid_identifier, \
  instantiations.standard,instantiations.data_rate,instantiations.location, \
  instantiations.tracks, instantiations.time_start, IFNULL(instantiations.digitized,'0') AS digitized, \
  GROUP_CONCAT(DISTINCT(instantiations.language) SEPARATOR ' | ') AS language, \
  IFNULL(TIME_TO_SEC(instantiations.actual_duration),0) AS actual_duration, \
  IFNULL(instantiations.projected_duration,'0') AS projected_duration, \
  instantiations.file_size_unit_of_measure, instantiations.file_size, instantiations.channel_configuration, \
  instantiations.alternative_modes, ins_data_rate_units.unit_of_measure AS data_rate_unit_of_measure, \
  GROUP_CONCAT(DISTINCT(asset_titles.title) SEPARATOR ' | ') AS asset_title, \
  GROUP_CONCAT(DISTINCT(IFNULL(`asset_titles`.`title_source`,'(**)')) SEPARATOR ' | ') AS asset_title_source, \
  GROUP_CONCAT(DISTINCT(IFNULL(`asset_titles`.`title_ref`,'(**)')) SEPARATOR ' | ') AS asset_title_ref, \
  GROUP_CONCAT(DISTINCT(IFNULL(`asset_title_types`.`title_type`,'(**)')) SEPARATOR ' | ') AS asset_title_type, \
  stations.station_name AS organization, \
  stations.state, \
  IFNULL(UNIX_TIMESTAMP(instantiation_dates.instantiation_date ),0) AS dates, \
  date_types.date_type AS date_type, \
  GROUP_CONCAT(DISTINCT(instantiation_media_types.media_type) SEPARATOR ' | ') AS media_type, \
  instantiation_formats.format_type, \
  instantiation_formats.format_name, \
  instantiation_colors.color, \
  GROUP_CONCAT(DISTINCT(`generations`.`generation`) SEPARATOR ' | ') AS generation, \
`generations`.`generation` AS facet_generation, \
  nomination_status.status, \
  nominations.nomination_reason, \
  nominations.nominated_by, \
  nominations.nominated_at,\
  CASE WHEN events.event_outcome=0 THEN 'FAIL' WHEN events.event_outcome=1 THEN 'PASS' END AS outcome_event, \
  event_types.event_type, \
  IFNULL(UNIX_TIMESTAMP(events.event_date ),0) AS event_date, \
  GROUP_CONCAT(DISTINCT(IFNULL(instantiation_identifier.instantiation_identifier,'(**)')) SEPARATOR ' | ') AS instantiation_identifier, \
  GROUP_CONCAT(DISTINCT(IFNULL(instantiation_identifier.instantiation_source,'(**)')) SEPARATOR ' | ') AS instantiation_source, \
  GROUP_CONCAT(DISTINCT(IFNULL(`subjects`.`subject`,'(**)')) SEPARATOR ' | ') AS asset_subject, \
  GROUP_CONCAT(DISTINCT(IFNULL(`coverages`.`coverage`,'(**)')) SEPARATOR ' | ') AS asset_coverage, \
  GROUP_CONCAT(DISTINCT(IFNULL(`coverages`.`coverage_type`,'(**)')) SEPARATOR ' | ') AS asset_coverage_type, \
  GROUP_CONCAT(DISTINCT(IFNULL(`publishers`.`publisher`,'(**)')) SEPARATOR ' | ') AS asset_publisher_name, \
  GROUP_CONCAT(DISTINCT(IFNULL(`publishers`.`publisher_affiliation`,'(**)')) SEPARATOR ' | ') AS asset_publisher_affiliation, \
  GROUP_CONCAT(DISTINCT(IFNULL(`publishers`.`publisher_ref`,'(**)')) SEPARATOR ' | ') AS asset_publisher_ref, \
  GROUP_CONCAT(DISTINCT(IFNULL(`publisher_roles`.`publisher_role`,'(**)')) SEPARATOR ' | ') AS asset_publisher_role, \
  GROUP_CONCAT(DISTINCT(IFNULL(`publisher_roles`.`publisher_role_source`,'(**)')) SEPARATOR ' | ') AS asset_publisher_role_source, \
  GROUP_CONCAT(DISTINCT(IFNULL(`publisher_roles`.`publisher_role_ref`,'(**)')) SEPARATOR ' | ') AS asset_publisher_role_ref, \
  `asset_descriptions`.`description` AS asset_description, \
  IFNULL(`description_types`.`description_type`,'') AS description_type, \
  GROUP_CONCAT(DISTINCT(IFNULL(`creators`.`creator_name`,'(**)')) SEPARATOR ' | ') AS asset_creator_name, \
  GROUP_CONCAT(DISTINCT(IFNULL(`creators`.`creator_affiliation`,'(**)')) SEPARATOR ' | ') AS asset_creator_affiliation, \
  GROUP_CONCAT(DISTINCT(IFNULL(`creators`.`creator_source`,'(**)')) SEPARATOR ' | ') AS asset_creator_source, \
  GROUP_CONCAT(DISTINCT(IFNULL(`creators`.`creator_ref`,'(**)')) SEPARATOR ' | ') AS asset_creator_ref, \
  GROUP_CONCAT(DISTINCT(IFNULL(`creator_roles`.`creator_role`,'(**)')) SEPARATOR ' | ') AS asset_creator_role, \
  GROUP_CONCAT(DISTINCT(IFNULL(`creator_roles`.`creator_role_source`,'(**)')) SEPARATOR ' | ') AS asset_creator_role_source, \
  GROUP_CONCAT(DISTINCT(IFNULL(`creator_roles`.`creator_role_ref`,'(**)')) SEPARATOR ' | ') AS asset_creator_role_ref, \
  GROUP_CONCAT(DISTINCT(IFNULL(`contributors`.`contributor_name`,'(**)')) SEPARATOR ' | ') AS asset_contributor_name, \
  GROUP_CONCAT(DISTINCT(IFNULL(`contributors`.`contributor_affiliation`,'(**)')) SEPARATOR ' | ') AS asset_contributor_affiliation, \
  GROUP_CONCAT(DISTINCT(IFNULL(`contributors`.`contributor_source`,'(**)')) SEPARATOR ' | ') AS asset_contributor_source, \
  GROUP_CONCAT(DISTINCT(IFNULL(`contributors`.`contributor_ref`,'(**)')) SEPARATOR ' | ') AS asset_contributor_ref, \
  GROUP_CONCAT(DISTINCT(IFNULL(`contributor_roles`.`contributor_role`,'(**)')) SEPARATOR ' | ') AS asset_contributor_role, \
  GROUP_CONCAT(DISTINCT(IFNULL(`contributor_roles`.`contributor_role_source`,'(**)')) SEPARATOR ' | ') AS asset_contributor_role_source, \
  GROUP_CONCAT(DISTINCT(IFNULL(`contributor_roles`.`contributor_role_ref`,'(**)')) SEPARATOR ' | ') AS asset_contributor_role_ref, \
  GROUP_CONCAT(DISTINCT(IFNULL(`rights_summaries`.`rights`,'(**)')) SEPARATOR ' | ') AS asset_rights, \
  GROUP_CONCAT(DISTINCT(IFNULL(`rights_summaries`.`rights_link`,'(**)')) SEPARATOR ' | ') AS asset_rights_link, \
  GROUP_CONCAT(DISTINCT(IFNULL(`annotations`.`annotation`,'(**)')) SEPARATOR ' | ') AS asset_annotation, \
  GROUP_CONCAT(DISTINCT(IFNULL(`annotations`.`annotation_type`,'(**)')) SEPARATOR ' | ') AS asset_annotation_type, \
  GROUP_CONCAT(DISTINCT(IFNULL(`annotations`.`annotation_ref`,'(**)')) SEPARATOR ' | ') AS asset_annotation_ref, \
  GROUP_CONCAT(DISTINCT(IFNULL(`genres`.`genre`,'(**)')) SEPARATOR ' | ') AS asset_genre, \
  GROUP_CONCAT(DISTINCT(IFNULL(`genres`.`genre_source`,'(**)')) SEPARATOR ' | ') AS asset_genre_source, \
  GROUP_CONCAT(DISTINCT(IFNULL(`genres`.`genre_ref`,'(**)')) SEPARATOR ' | ') AS asset_genre_ref, instantiation_dimensions.instantiation_dimension, \
  instantiation_dimensions.unit_of_measure, \
  essence_tracks.standard AS track_standard, \
  essence_tracks.duration AS track_duration, \
  essence_tracks.language AS track_language, \
  essence_tracks.frame_rate AS track_frame_rate, \
  essence_tracks.playback_speed AS track_playback_speed, \
  essence_tracks.sampling_rate AS track_sampling_rate, \
  essence_tracks.bit_depth AS track_bit_depth, \
  essence_tracks.aspect_ratio AS track_aspect_ratio, \
  essence_tracks.data_rate AS track_data_rate, \
  data_rate_units.unit_of_measure AS track_unit_of_measure, \
  essence_track_types.essence_track_type AS track_essence_track_type, \
  essence_track_frame_sizes.width AS track_width, \
  essence_track_frame_sizes.height AS track_height, \
  essence_track_encodings.encoding AS track_encoding, \
  essence_track_encodings.encoding_source AS track_encoding_source, \
  essence_track_encodings.encoding_ref AS track_encoding_ref, \
  essence_track_annotations.annotation AS track_annotation, \
  essence_track_annotations.annotation_type AS track_annotation_type, \
  GROUP_CONCAT(DISTINCT(IFNULL(instantiation_annotations.annotation,'(**)')) SEPARATOR ' | ') AS ins_annotation,\
  GROUP_CONCAT(DISTINCT(IFNULL(instantiation_annotations.annotation_type,'(**)')) SEPARATOR ' | ') AS ins_annotation_type \
   FROM (`instantiations`) \
  LEFT JOIN `assets` ON `assets`.`id` = `instantiations`.`assets_id` \
  LEFT JOIN `identifiers` ON `identifiers`.`assets_id` = `assets`.`id`  AND `identifiers`.`identifier_source` = 'http://americanarchiveinventory.org'  \
  LEFT JOIN `asset_titles` ON `asset_titles`.`assets_id` = `instantiations`.`assets_id` \
  LEFT JOIN `asset_title_types` ON `asset_titles`.`asset_title_types_id` = `asset_title_types`.`id` \
  JOIN `stations` ON `stations`.`id` = `assets`.`stations_id` \
  LEFT JOIN `instantiation_dates` ON `instantiation_dates`.`instantiations_id` = `instantiations`.`id` \
  LEFT JOIN `date_types` ON `date_types`.`id` = `instantiation_dates`.`date_types_id` \
  LEFT JOIN `instantiation_media_types` ON `instantiation_media_types`.`id` = `instantiations`.`instantiation_media_type_id` \
  LEFT JOIN `instantiation_formats` ON `instantiation_formats`.`instantiations_id` = `instantiations`.`id` \
  LEFT JOIN `instantiation_colors` ON `instantiation_colors`.`id` = `instantiations`.`instantiation_colors_id` \
  LEFT JOIN `instantiation_identifier` ON `instantiations`.`id` = `instantiation_identifier`.`instantiations_id` \
  LEFT JOIN `instantiation_generations` ON `instantiation_generations`.`instantiations_id` = `instantiations`.`id`\
  LEFT JOIN `generations` ON `generations`.`id` = `instantiation_generations`.`generations_id`\
  LEFT JOIN `nominations` ON `nominations`.`instantiations_id` = `instantiations`.`id`\
  LEFT JOIN `nomination_status` ON `nomination_status`.`id` = `nominations`.`nomination_status_id`\
 LEFT JOIN `events` ON `events`.`instantiations_id` = `instantiations`.`id` AND  `events`.`event_types_id`='3'\
 LEFT JOIN `event_types` ON `event_types`.`id` = `events`.`event_types_id` AND event_types.event_type='migration'\
 LEFT JOIN `assets_subjects` ON `assets_subjects`.`assets_id` = `assets`.`id`\
 LEFT JOIN `subjects` ON `subjects`.`id` = `assets_subjects`.`subjects_id`\
 LEFT JOIN `coverages` ON `coverages`.`assets_id`=`assets`.`id` \
 LEFT JOIN `assets_genres` ON `assets_genres`.`assets_id` = `assets`.`id`\
 LEFT JOIN `genres` ON `genres`.`id` = `assets_genres`.`genres_id` \
 LEFT JOIN `assets_publishers_role` ON `assets_publishers_role`.`assets_id`=`assets`.`id` \
 LEFT JOIN `publisher_roles` ON `assets_publishers_role`.`publisher_roles_id`=`publisher_roles`.`id` \
 LEFT JOIN `publishers` ON `assets_publishers_role`.`publishers_id`=`publishers`.`id` \
 LEFT JOIN `asset_descriptions` ON `asset_descriptions`.`assets_id` = `assets`.`id` \
 LEFT JOIN `description_types` ON `description_types`.`id` = `asset_descriptions`.`description_types_id` \
 LEFT JOIN `assets_creators_roles` ON `assets_creators_roles`.`assets_id`=`assets`.`id` \
 LEFT JOIN `creator_roles` ON `assets_creators_roles`.`creator_roles_id`=`creator_roles`.`id` \
 LEFT JOIN `creators` ON `assets_creators_roles`.`creators_id`=`creators`.`id` \
 LEFT JOIN `assets_contributors_roles` ON `assets_contributors_roles`.`assets_id`=`assets`.`id` \
 LEFT JOIN `contributor_roles` ON `assets_contributors_roles`.`contributor_roles_id`=`contributor_roles`.`id` \
 LEFT JOIN `contributors` ON `assets_contributors_roles`.`contributors_id`=`contributors`.`id` \
 LEFT JOIN `rights_summaries` ON `rights_summaries`.`assets_id`=`assets`.`id` \
 LEFT JOIN `annotations` ON `annotations`.`assets_id`=`assets`.`id` \
 LEFT JOIN `instantiation_dimensions` ON `instantiation_dimensions`.`instantiations_id`=`instantiations`.`id` \
 LEFT JOIN `essence_tracks` ON `essence_tracks`.`instantiations_id`=`instantiations`.`id` \
 LEFT JOIN `data_rate_units` AS `ins_data_rate_units` ON `ins_data_rate_units`.`id`=`instantiations`.`data_rate_units_id` \
 LEFT JOIN `data_rate_units` ON `data_rate_units`.`id`=`essence_tracks`.`data_rate_units_id` \
 LEFT JOIN `essence_track_types` ON `essence_track_types`.`id`=`essence_tracks`.`essence_track_types_id` \
 LEFT JOIN `essence_track_frame_sizes` ON `essence_track_frame_sizes`.`id`=`essence_tracks`.`essence_track_frame_sizes_id` \
 LEFT JOIN `essence_track_encodings` ON `essence_track_encodings`.`essence_tracks_id`=`essence_tracks`.`id` \
 LEFT JOIN `essence_track_annotations` ON `essence_track_annotations`.`essence_tracks_id`=`essence_tracks`.`id` \
 LEFT JOIN `instantiation_annotations` ON `instantiation_annotations`.`instantiations_id`=`instantiations`.`id` \
 WHERE instantiations.id>=$start AND instantiations.id<=$end \
 GROUP BY `instantiations`.`id`

 sql_attr_uint = assets_id
 sql_field_string = language
 sql_field_string = digitized
 sql_field_string = standard
 sql_field_string = time_start
 sql_field_string = location
 sql_field_string = tracks
 sql_field_string = data_rate_unit_of_measure
 sql_attr_uint = actual_duration
 sql_field_string = projected_duration
 sql_field_string = file_size_unit_of_measure
 sql_field_string = file_size
 sql_field_string = channel_configuration
 sql_field_string = alternative_modes
 sql_field_string = asset_title
 sql_field_string = asset_title_source
 sql_field_string = asset_title_ref
 sql_field_string = asset_title_type
 sql_field_string = organization
 sql_attr_uint = dates
 sql_attr_uint = event_date
 sql_field_string = date_type
 sql_field_string = media_type
 sql_field_string = format_type
 sql_field_string = format_name
 sql_field_string = color
 sql_field_string = generation
 sql_field_string = status
 sql_field_string = nomination_reason
 sql_field_string = nominated_by
 sql_field_string = nominated_at
 sql_field_string = outcome_event
 sql_field_string = event_type
 sql_field_string = instantiation_identifier
 sql_field_string = instantiation_source
 sql_field_string = asset_subject
 sql_field_string = asset_coverage
 sql_field_string = asset_coverage_type
 sql_field_string = asset_publisher_name
 sql_field_string = asset_publisher_affiliation
 sql_field_string = asset_publisher_ref
 sql_field_string = asset_publisher_role
 sql_field_string = asset_publisher_role_source
 sql_field_string = asset_publisher_role_ref
 sql_field_string = asset_description
 sql_field_string = description_type
 sql_field_string = asset_creator_name
 sql_field_string = asset_creator_affiliation
 sql_field_string = asset_creator_source
 sql_field_string = asset_creator_ref
 sql_field_string = asset_creator_role
 sql_field_string = asset_creator_role_source
 sql_field_string = asset_creator_role_ref
 sql_field_string = asset_contributor_name
 sql_field_string = asset_contributor_affiliation
 sql_field_string = asset_contributor_source
 sql_field_string = asset_contributor_ref
 sql_field_string = asset_contributor_role
 sql_field_string = asset_contributor_role_source
 sql_field_string = asset_contributor_role_ref
 sql_field_string = asset_rights
 sql_field_string = asset_rights_link
 sql_field_string = asset_annotation
 sql_field_string = asset_annotation_type
 sql_field_string = asset_annotation_ref
 sql_field_string = instantiation_dimension
 sql_field_string = unit_of_measure
 sql_field_string = track_standard
 sql_field_string = track_language
 sql_field_string = track_frame_rate
 sql_field_string = track_playback_speed
 sql_field_string = track_sampling_rate
 sql_field_string = track_bit_depth
 sql_field_string = track_aspect_ratio
 sql_field_string = track_data_rate
 sql_field_string = track_unit_of_measure
 sql_field_string = track_essence_track_type
 sql_field_string = track_width
 sql_field_string = track_height
 sql_field_string = track_encoding
 sql_field_string = track_encoding_source
 sql_field_string = track_encoding_ref
 sql_field_string = track_annotation
 sql_field_string = track_annotation_type
 sql_field_string = asset_genre
 sql_field_string = asset_genre_source
 sql_field_string = asset_genre_ref
 sql_field_string = data_rate
 sql_field_string = track_duration
 sql_field_string = ins_annotation
 sql_field_string = ins_annotation_type
 sql_field_string = guid_identifier
 sql_field_string = state
 sql_field_string = facet_generation
}


index instantiations_list
{
 source  = instantiations_list_src
 path  = /var/lib/sphinx/instantiations_list_src
 docinfo  = extern
 charset_type   = sbcs
}
  

source assets_list_src
{
 type= mysql
 sql_host= localhost
 sql_user= ams
 sql_pass= xoho@123
 sql_db = ams
 sql_port= 3306 # optional, default is 3306
 sql_query_pre = SET NAMES utf8
 sql_query_pre = SET SESSION query_cache_type=OFF  
 sql_query_range = SELECT MIN(id),MAX(id) FROM assets
 sql_range_step = 1000
  
 sql_query = SELECT `assets`.`id`, `identifiers`.`identifier` AS guid_identifier, `asset_descriptions`.`description`,stations.station_name AS organization, \
 stations.state, \
 IFNULL(`description_types`.`description_type`,'') AS description_type, \
 GROUP_CONCAT(DISTINCT(IFNULL(`local`.`identifier`,'(**)')) SEPARATOR ' | ') AS local_identifier, \
 GROUP_CONCAT(DISTINCT(IFNULL(`asset_titles`.`title`,'(**)')) SEPARATOR ' | ') AS asset_title, \
 GROUP_CONCAT(DISTINCT(IFNULL(`asset_titles`.`title_source`,'(**)')) SEPARATOR ' | ') AS asset_title_source, \
 GROUP_CONCAT(DISTINCT(IFNULL(`asset_titles`.`title_ref`,'(**)')) SEPARATOR ' | ') AS asset_title_ref, \
 GROUP_CONCAT(DISTINCT(IFNULL(`asset_title_types`.`title_type`,'(**)')) SEPARATOR ' | ') AS asset_title_type, \
 GROUP_CONCAT(DISTINCT(IFNULL(`subjects`.`subject`,'(**)')) SEPARATOR ' | ') AS asset_subject, \
 GROUP_CONCAT(DISTINCT(IFNULL(`subjects`.subject_source,'(**)')) SEPARATOR ' | ') AS asset_subject_source, \
 GROUP_CONCAT(DISTINCT(IFNULL(`subjects`.subject_ref,'(**)')) SEPARATOR ' | ') AS asset_subject_ref, \
 GROUP_CONCAT(DISTINCT(IFNULL(`genres`.`genre`,'(**)')) SEPARATOR ' | ') AS asset_genre, \
 GROUP_CONCAT(DISTINCT(IFNULL(`genres`.`genre_source`,'(**)')) SEPARATOR ' | ') AS asset_genre_source, \
 GROUP_CONCAT(DISTINCT(IFNULL(`genres`.`genre_ref`,'(**)')) SEPARATOR ' | ') AS asset_genre_ref, \
 GROUP_CONCAT(DISTINCT(IFNULL(`creators`.`creator_name`,'(**)')) SEPARATOR ' | ') AS asset_creator_name, \
 GROUP_CONCAT(DISTINCT(IFNULL(`creators`.`creator_affiliation`,'(**)')) SEPARATOR ' | ') AS asset_creator_affiliation, \
 GROUP_CONCAT(DISTINCT(IFNULL(`creators`.`creator_source`,'(**)')) SEPARATOR ' | ') AS asset_creator_source, \
 GROUP_CONCAT(DISTINCT(IFNULL(`creators`.`creator_ref`,'(**)')) SEPARATOR ' | ') AS asset_creator_ref, \
 GROUP_CONCAT(DISTINCT(IFNULL(`creator_roles`.`creator_role`,'(**)')) SEPARATOR ' | ') AS asset_creator_role, \
 GROUP_CONCAT(DISTINCT(IFNULL(`creator_roles`.`creator_role_source`,'(**)')) SEPARATOR ' | ') AS asset_creator_role_source, \
 GROUP_CONCAT(DISTINCT(IFNULL(`creator_roles`.`creator_role_ref`,'(**)')) SEPARATOR ' | ') AS asset_creator_role_ref, \
 GROUP_CONCAT(DISTINCT(IFNULL(`contributors`.`contributor_name`,'(**)')) SEPARATOR ' | ') AS asset_contributor_name, \
 GROUP_CONCAT(DISTINCT(IFNULL(`contributors`.`contributor_affiliation`,'(**)')) SEPARATOR ' | ') AS asset_contributor_affiliation, \
 GROUP_CONCAT(DISTINCT(IFNULL(`contributors`.`contributor_source`,'(**)')) SEPARATOR ' | ') AS asset_contributor_source, \
 GROUP_CONCAT(DISTINCT(IFNULL(`contributors`.`contributor_ref`,'(**)')) SEPARATOR ' | ') AS asset_contributor_ref, \
 GROUP_CONCAT(DISTINCT(IFNULL(`contributor_roles`.`contributor_role`,'(**)')) SEPARATOR ' | ') AS asset_contributor_role, \
 GROUP_CONCAT(DISTINCT(IFNULL(`contributor_roles`.`contributor_role_source`,'(**)')) SEPARATOR ' | ') AS asset_contributor_role_source, \
 GROUP_CONCAT(DISTINCT(IFNULL(`contributor_roles`.`contributor_role_ref`,'(**)')) SEPARATOR ' | ') AS asset_contributor_role_ref, \
 GROUP_CONCAT(DISTINCT(IFNULL(`publishers`.`publisher`,'(**)')) SEPARATOR ' | ') AS asset_publisher_name, \
 GROUP_CONCAT(DISTINCT(IFNULL(`publishers`.`publisher_affiliation`,'(**)')) SEPARATOR ' | ') AS asset_publisher_affiliation, \
 GROUP_CONCAT(DISTINCT(IFNULL(`publishers`.`publisher_ref`,'(**)')) SEPARATOR ' | ') AS asset_publisher_ref, \
 GROUP_CONCAT(DISTINCT(IFNULL(`publisher_roles`.`publisher_role`,'(**)')) SEPARATOR ' | ') AS asset_publisher_role, \
 GROUP_CONCAT(DISTINCT(IFNULL(`publisher_roles`.`publisher_role_source`,'(**)')) SEPARATOR ' | ') AS asset_publisher_role_source, \
 GROUP_CONCAT(DISTINCT(IFNULL(`publisher_roles`.`publisher_role_ref`,'(**)')) SEPARATOR ' | ') AS asset_publisher_role_ref, \
 GROUP_CONCAT(DISTINCT(IFNULL(UNIX_TIMESTAMP(`asset_dates`.`asset_date`),0)) SEPARATOR ' | ') AS dates, \
 GROUP_CONCAT(DISTINCT(IFNULL(`date_types`.`date_type`,'(**)')) SEPARATOR ' | ') AS date_type, \
 GROUP_CONCAT(DISTINCT(IFNULL(`coverages`.`coverage`,'(**)')) SEPARATOR ' | ') AS asset_coverage, \
 GROUP_CONCAT(DISTINCT(IFNULL(`coverages`.`coverage_type`,'(**)')) SEPARATOR ' | ') AS asset_coverage_type, \
 GROUP_CONCAT(DISTINCT(IFNULL(`audience_levels`.`audience_level`,'(**)')) SEPARATOR ' | ') AS asset_audience_level, \
 GROUP_CONCAT(DISTINCT(IFNULL(`audience_levels`.`audience_level_source`,'(**)')) SEPARATOR ' | ') AS asset_audience_level_source, \
 GROUP_CONCAT(DISTINCT(IFNULL(`audience_levels`.`audience_level_ref`,'(**)')) SEPARATOR ' | ') AS asset_audience_level_ref, \
 GROUP_CONCAT(DISTINCT(IFNULL(`audience_ratings`.`audience_rating`,'(**)')) SEPARATOR ' | ') AS asset_audience_rating, \
 GROUP_CONCAT(DISTINCT(IFNULL(`audience_ratings`.`audience_rating_source`,'(**)')) SEPARATOR ' | ') AS asset_audience_rating_source, \
 GROUP_CONCAT(DISTINCT(IFNULL(`audience_ratings`.`audience_rating_ref`,'(**)')) SEPARATOR ' | ') AS asset_audience_rating_ref, \
 GROUP_CONCAT(DISTINCT(IFNULL(`annotations`.`annotation`,'(**)')) SEPARATOR ' | ') AS asset_annotation, \
 GROUP_CONCAT(DISTINCT(IFNULL(`annotations`.`annotation_type`,'(**)')) SEPARATOR ' | ') AS asset_annotation_type, \
 GROUP_CONCAT(DISTINCT(IFNULL(`annotations`.`annotation_ref`,'(**)')) SEPARATOR ' | ') AS asset_annotation_ref, \
 GROUP_CONCAT(DISTINCT(IFNULL(`rights_summaries`.`rights`,'(**)')) SEPARATOR ' | ') AS asset_rights, \
 GROUP_CONCAT(DISTINCT(IFNULL(`rights_summaries`.`rights_link`,'(**)')) SEPARATOR ' | ') AS asset_rights_link, \
 GROUP_CONCAT(DISTINCT(IFNULL(`instantiations`.`standard`,'(**)')) SEPARATOR ' | ') AS `standard`, \
 GROUP_CONCAT(DISTINCT(IFNULL(`instantiations`.`location`,'(**)')) SEPARATOR ' | ') AS `location`, \
 GROUP_CONCAT(DISTINCT(IFNULL(`instantiations`.`tracks`,'(**)')) SEPARATOR ' | ') AS `tracks`, \
 GROUP_CONCAT(DISTINCT(IFNULL(`instantiations`.`language`,'(**)')) SEPARATOR ' | ') AS `language`, \
 IFNULL(instantiations.digitized,'0') AS digitized, \
 GROUP_CONCAT(DISTINCT(IFNULL(TIME_TO_SEC(instantiations.actual_duration),0)) SEPARATOR ' | ') AS actual_duration, \
 GROUP_CONCAT(DISTINCT(IFNULL(instantiations.projected_duration,'0')) SEPARATOR ' | ') AS projected_duration, \
 GROUP_CONCAT(DISTINCT(IFNULL(`instantiations`.`file_size_unit_of_measure`,'(**)')) SEPARATOR ' | ') AS `file_size_unit_of_measure`, \
 GROUP_CONCAT(DISTINCT(IFNULL(`instantiations`.`file_size`,'(**)')) SEPARATOR ' | ') AS `file_size`, \
 GROUP_CONCAT(DISTINCT(IFNULL(`instantiations`.`channel_configuration`,'(**)')) SEPARATOR ' | ') AS `channel_configuration`, \
 GROUP_CONCAT(DISTINCT(IFNULL(`instantiations`.`alternative_modes`,'(**)')) SEPARATOR ' | ') AS `alternative_modes`, \
 GROUP_CONCAT(DISTINCT(IFNULL(UNIX_TIMESTAMP(instantiation_dates.instantiation_date ),0)) SEPARATOR ' | ') AS instantiation_date, \
 GROUP_CONCAT(DISTINCT(instantiation_media_types.media_type) SEPARATOR ' | ') AS media_type, \
 instantiation_formats.format_type, \
 instantiation_formats.format_name, \
 GROUP_CONCAT(DISTINCT(IFNULL(instantiation_colors.color,'(**)'))  SEPARATOR ' | ') AS  color, \
 GROUP_CONCAT(DISTINCT(`generations`.`generation`) SEPARATOR ' | ') AS generation, \
 `generations`.`generation` AS facet_generation, \
 nomination_status.status, \
 GROUP_CONCAT(DISTINCT(IFNULL(instantiation_identifier.instantiation_identifier,'(**)'))  SEPARATOR ' | ') AS  `instantiation_identifier`, \
 GROUP_CONCAT(DISTINCT(IFNULL(instantiation_identifier.instantiation_source,'(**)'))  SEPARATOR ' | ') AS  `instantiation_source`, \
 GROUP_CONCAT(DISTINCT(IFNULL(`instantiation_dimensions`.`instantiation_dimension`,'(**)')) SEPARATOR ' | ') AS  `instantiation_dimension` , \
 GROUP_CONCAT(DISTINCT(IFNULL(`instantiation_dimensions`.`unit_of_measure`,'(**)'))  SEPARATOR ' | ')AS  `unit_of_measure` , \
 GROUP_CONCAT(DISTINCT(IFNULL(`essence_tracks`.`standard`,'(**)')) SEPARATOR ' | ') AS  `track_standard` , \
 GROUP_CONCAT(DISTINCT(IFNULL(`essence_tracks`.`language`,'(**)')) SEPARATOR ' | ') AS  `track_language` , \
 GROUP_CONCAT(DISTINCT(IFNULL(`essence_tracks`.`frame_rate`,'(**)')) SEPARATOR ' | ') AS  `track_frame_rate` , \
 GROUP_CONCAT(DISTINCT(IFNULL(`essence_tracks`.`playback_speed`,'(**)')) SEPARATOR ' | ') AS  `track_playback_speed` , \
 GROUP_CONCAT(DISTINCT(IFNULL(`essence_tracks`.`sampling_rate`,'(**)')) SEPARATOR ' | ') AS  `track_sampling_rate` , \
 GROUP_CONCAT(DISTINCT(IFNULL(`essence_tracks`.`bit_depth`,'(**)')) SEPARATOR ' | ') AS  `track_bit_depth` , \
 GROUP_CONCAT(DISTINCT(IFNULL(`essence_tracks`.`aspect_ratio`,'(**)')) SEPARATOR ' | ') AS  `track_aspect_ratio` , \
 GROUP_CONCAT(DISTINCT(IFNULL(`essence_tracks`.`data_rate`,'(**)')) SEPARATOR ' | ') AS  `track_data_rate` , \
 GROUP_CONCAT(DISTINCT(IFNULL(`data_rate_units`.`unit_of_measure`,'(**)')) SEPARATOR ' | ') AS  `track_unit_of_measure` , \
 GROUP_CONCAT(DISTINCT(IFNULL(`essence_track_types`.`essence_track_type`,'(**)')) SEPARATOR ' | ') AS  `track_essence_track_type` , \
 GROUP_CONCAT(DISTINCT(IFNULL(`essence_track_frame_sizes`.`width`,'(**)')) SEPARATOR ' | ') AS  `track_width` , \
 GROUP_CONCAT(DISTINCT(IFNULL(`essence_track_frame_sizes`.`height`,'(**)')) SEPARATOR ' | ') AS  `track_height` , \
 GROUP_CONCAT(DISTINCT(IFNULL(`essence_track_encodings`.`encoding`,'(**)')) SEPARATOR ' | ') AS  `track_encoding` , \
 GROUP_CONCAT(DISTINCT(IFNULL(`essence_track_encodings`.`encoding_source`,'(**)')) SEPARATOR ' | ') AS  `track_encoding_source` , \
 GROUP_CONCAT(DISTINCT(IFNULL(`essence_track_encodings`.`encoding_ref`,'(**)')) SEPARATOR ' | ') AS  `track_encoding_ref` , \
 GROUP_CONCAT(DISTINCT(IFNULL(`essence_track_annotations`.`annotation`,'(**)')) SEPARATOR ' | ') AS  `track_annotation` , \
 GROUP_CONCAT(DISTINCT(IFNULL(`essence_track_annotations`.`annotation_type`,'(**)')) SEPARATOR ' | ') AS  `track_annotation_type`, \
 GROUP_CONCAT(DISTINCT(IFNULL(instantiation_annotations.annotation,'(**)')) SEPARATOR ' | ') AS ins_annotation,\
 GROUP_CONCAT(DISTINCT(IFNULL(instantiation_annotations.annotation_type,'(**)')) SEPARATOR ' | ') AS ins_annotation_type \
 FROM (`assets`) \
 LEFT JOIN `identifiers` AS `local` ON `local`.`assets_id` = `assets`.`id` AND `local`.`identifier_source` != 'http://americanarchiveinventory.org' \
 LEFT JOIN `identifiers` ON `identifiers`.`assets_id` = `assets`.`id`  AND `identifiers`.`identifier_source` = 'http://americanarchiveinventory.org'  \
 LEFT JOIN `asset_descriptions` ON `asset_descriptions`.`assets_id` = `assets`.`id` \
 LEFT JOIN `description_types` ON `description_types`.`id` = `asset_descriptions`.`description_types_id` \
 LEFT JOIN `asset_titles` ON `asset_titles`.`assets_id` = `assets`.`id` \
 LEFT JOIN `asset_title_types` ON `asset_titles`.`asset_title_types_id` = `asset_title_types`.`id` \
 LEFT JOIN `assets_subjects` ON `assets_subjects`.`assets_id` = `assets`.`id` \
 LEFT JOIN `subjects` ON `subjects`.`id` = `assets_subjects`.`subjects_id` \
 LEFT JOIN `assets_genres` ON `assets_genres`.`assets_id` = `assets`.`id` \
 LEFT JOIN `genres` ON `genres`.`id` = `assets_genres`.`genres_id` \
 LEFT JOIN `assets_creators_roles` ON `assets_creators_roles`.`assets_id`=`assets`.`id` \
 LEFT JOIN `creator_roles` ON `assets_creators_roles`.`creator_roles_id`=`creator_roles`.`id` \
 LEFT JOIN `creators` ON `assets_creators_roles`.`creators_id`=`creators`.`id` \
 LEFT JOIN `assets_contributors_roles` ON `assets_contributors_roles`.`assets_id`=`assets`.`id` \
 LEFT JOIN `contributor_roles` ON `assets_contributors_roles`.`contributor_roles_id`=`contributor_roles`.`id` \
 LEFT JOIN `contributors` ON `assets_contributors_roles`.`contributors_id`=`contributors`.`id` \
 LEFT JOIN `assets_publishers_role` ON `assets_publishers_role`.`assets_id`=`assets`.`id` \
 LEFT JOIN `publisher_roles` ON `assets_publishers_role`.`publisher_roles_id`=`publisher_roles`.`id` \
 LEFT JOIN `publishers` ON `assets_publishers_role`.`publishers_id`=`publishers`.`id` \
 LEFT JOIN `asset_dates` ON `asset_dates`.`assets_id`=`assets`.`id` \
 LEFT JOIN `date_types` ON `asset_dates`.`date_types_id`=`date_types`.`id` \
 LEFT JOIN `coverages` ON `coverages`.`assets_id`=`assets`.`id` \
 LEFT JOIN `assets_audience_levels` ON `assets_audience_levels`.`assets_id`=`assets`.`id` \
 LEFT JOIN `audience_levels` ON `assets_audience_levels`.`audience_levels_id`=`audience_levels`.`id` \
 LEFT JOIN `assets_audience_ratings` ON `assets_audience_ratings`.`assets_id`=`assets`.`id` \
 LEFT JOIN `audience_ratings` ON `assets_audience_ratings`.`audience_ratings_id`=`audience_ratings`.`id` \
 LEFT JOIN `annotations` ON `annotations`.`assets_id`=`assets`.`id` \
 LEFT JOIN `rights_summaries` ON `rights_summaries`.`assets_id`=`assets`.`id` \
 LEFT JOIN `instantiations` ON `instantiations`.`assets_id`=`assets`.`id` \
 LEFT JOIN `stations` ON `stations`.`id` = `assets`.`stations_id` \
 LEFT JOIN `instantiation_dates` ON `instantiation_dates`.`instantiations_id` = `instantiations`.`id` \
 LEFT JOIN `date_types` AS `ins_date_types` ON `ins_date_types`.`id` = `instantiation_dates`.`date_types_id` \
 LEFT JOIN `instantiation_media_types` ON `instantiation_media_types`.`id` = `instantiations`.`instantiation_media_type_id` \
 LEFT JOIN `instantiation_formats` ON `instantiation_formats`.`instantiations_id` = `instantiations`.`id` \
 LEFT JOIN `instantiation_colors` ON `instantiation_colors`.`id` = `instantiations`.`instantiation_colors_id` \
 LEFT JOIN `instantiation_identifier` ON `instantiations`.`id` = `instantiation_identifier`.`instantiations_id` \
 LEFT JOIN `instantiation_generations` ON `instantiation_generations`.`instantiations_id` = `instantiations`.`id` \
 LEFT JOIN `generations` ON `generations`.`id` = `instantiation_generations`.`generations_id` \
 LEFT JOIN `nominations` ON `nominations`.`instantiations_id` = `instantiations`.`id` \
 LEFT JOIN `nomination_status` ON `nomination_status`.`id` = `nominations`.`nomination_status_id` \
 LEFT JOIN `events` ON `events`.`instantiations_id` = `instantiations`.`id` \
 LEFT JOIN `event_types` ON `event_types`.`id` = `events`.`event_types_id` \
 LEFT JOIN `instantiation_dimensions` ON `instantiation_dimensions`.`instantiations_id`=`instantiations`.`id` \
 LEFT JOIN `essence_tracks` ON `essence_tracks`.`instantiations_id`=`instantiations`.`id` \
 LEFT JOIN `data_rate_units` ON `data_rate_units`.`id`=`essence_tracks`.`data_rate_units_id` \
 LEFT JOIN `essence_track_types` ON `essence_track_types`.`id`=`essence_tracks`.`essence_track_types_id` \
 LEFT JOIN `essence_track_frame_sizes` ON `essence_track_frame_sizes`.`id`=`essence_tracks`.`essence_track_frame_sizes_id` \
 LEFT JOIN `essence_track_encodings` ON `essence_track_encodings`.`essence_tracks_id`=`essence_tracks`.`id` \
 LEFT JOIN `essence_track_annotations` ON `essence_track_annotations`.`essence_tracks_id`=`essence_tracks`.`id` \
 LEFT JOIN `instantiation_annotations` ON `instantiation_annotations`.`instantiations_id`=`instantiations`.`id` \
WHERE assets.id>=$start AND assets.id<=$end \
 GROUP BY `assets`.`id` 
 
 sql_field_string = guid_identifier
 sql_field_string = description
 sql_field_string = description_type
 sql_field_string = local_identifier
 sql_field_string = asset_title
 sql_field_string = asset_title_source
 sql_field_string = asset_title_ref
 sql_field_string = asset_title_type
 sql_field_string = asset_subject
 sql_field_string = asset_subject_source
 sql_field_string = asset_subject_ref
 sql_field_string = asset_genre
 sql_field_string = asset_genre_source
 sql_field_string = asset_genre_ref
 sql_field_string = asset_creator_name
 sql_field_string = asset_creator_affiliation
 sql_field_string = asset_creator_source
 sql_field_string = asset_creator_ref
 sql_field_string = asset_creator_role
 sql_field_string = asset_creator_role_source
 sql_field_string = asset_creator_role_ref
 sql_field_string = asset_contributor_name
 sql_field_string = asset_contributor_affiliation
 sql_field_string = asset_contributor_source
 sql_field_string = asset_contributor_ref
 sql_field_string = asset_contributor_role
 sql_field_string = asset_contributor_role_source
 sql_field_string = asset_contributor_role_ref
 sql_field_string = asset_publisher_name
 sql_field_string = asset_publisher_affiliation
 sql_field_string = asset_publisher_ref
 sql_field_string = asset_publisher_role
 sql_field_string = asset_publisher_role_source
 sql_field_string = asset_publisher_role_ref
 sql_attr_uint = dates
 sql_field_string = date_type
 sql_field_string = asset_coverage
 sql_field_string = asset_coverage_type
 sql_field_string = asset_audience_level
 sql_field_string = asset_audience_level_source
 sql_field_string = asset_audience_level_ref
 sql_field_string = asset_audience_rating
 sql_field_string = asset_audience_rating_source
 sql_field_string = asset_audience_rating_ref
 sql_field_string = asset_annotation
 sql_field_string = asset_annotation_type
 sql_field_string = asset_annotation_ref
 sql_field_string = asset_rights
 sql_field_string = asset_rights_link
 sql_field_string = language
 sql_field_string = digitized
 sql_field_string = standard
 sql_field_string = location
 sql_field_string = tracks
 sql_attr_uint = actual_duration
 sql_field_string = projected_duration
 sql_field_string = file_size_unit_of_measure
 sql_field_string = file_size
 sql_field_string = channel_configuration
 sql_field_string = alternative_modes
 sql_field_string = organization
 sql_attr_uint = instantiation_date
 sql_field_string = media_type
 sql_field_string = format_type
 sql_field_string = format_name
 sql_field_string = color
 sql_field_string = generation
 sql_field_string = status
 sql_field_string = instantiation_identifier
 sql_field_string = instantiation_source
 sql_field_string = instantiation_dimension
 sql_field_string = unit_of_measure
 sql_field_string = track_standard
 sql_field_string = track_language
 sql_field_string = track_frame_rate
 sql_field_string = track_playback_speed
 sql_field_string = track_sampling_rate
 sql_field_string = track_bit_depth
 sql_field_string = track_aspect_ratio
 sql_field_string = track_data_rate
 sql_field_string = track_unit_of_measure
 sql_field_string = track_essence_track_type
 sql_field_string = track_width
 sql_field_string = track_height
 sql_field_string = track_encoding
 sql_field_string = track_encoding_source
 sql_field_string = track_encoding_ref
 sql_field_string = track_annotation
 sql_field_string = track_annotation_type
 sql_field_string = ins_annotation
 sql_field_string = ins_annotation_type
 sql_field_string = state
 sql_field_string = facet_generation
}
index assets_list
{
 source  = assets_list_src
 path  = /var/lib/sphinx/assets_list_src
 docinfo  = extern
 charset_type   = sbcs
}
##CATALYST####



source catalyst_records_list_src
{
 type= mysql
 sql_host= localhost
 sql_user= catalyst
 sql_pass=xoho@123
 sql_db = catalyst
 sql_port= 3306 # optional, default is 3306
 sql_query_pre = SET NAMES utf8
 sql_query_pre = SET SESSION query_cache_type=OFF
 sql_query_range = SELECT MIN(id),MAX(id) FROM tbl_records
 sql_range_step = 1000

 sql_query=SELECT\
   tbl_records.id,\
   tbl_records.id as system_id,\
   tbl_records.user_id,\
   tbl_records.upload_id,\
   tbl_records.photographer_id,\
   tbl_records.unique_id,\
   tbl_records.unique_id_source,\
   tbl_records.format,\
   CONCAT(tbl_records.site,":",tbl_records.room,":",tbl_records.`row`,":",tbl_records.unit,":",tbl_records.shelf) as location,\
   tbl_records.media_type,\
   LRFV.field_value as series_title_str,\
   tbl_records.series_title,\
   tbl_records.program_title,\
   tbl_records.tap_title,\
   tbl_records.cc,\
   tbl_records.hd,\
   tbl_records.sap,\
   tbl_records.participants,\
   tbl_records.generation,\
   tbl_records.duration,\
   CASE WHEN tbl_records.qc_status='none' THEN 0 WHEN tbl_records.qc_status='pass' THEN 1 WHEN tbl_records.qc_status='fail' THEN 2 END AS qc_sts,\
   SUBSTRING_INDEX( tbl_records.`duration` , ':', 1 )*60+SUBSTRING_INDEX(SUBSTRING_INDEX( tbl_records.`duration` , ':', 2 ),':',-1) + SUBSTRING_INDEX(SUBSTRING_INDEX( tbl_records.`duration` , ':', -2 ),':',-1)/60 AS durationMins,\
   tbl_records.capacity,\
   tbl_records.air_date,\
   tbl_records.record_date,\
   tbl_records.note,\
   tbl_records.sup_review,\
   tbl_records.client_id,\
   tbl_records.site,\
   tbl_records.room,\
   tbl_records.row,\
   tbl_records.unit,\
   tbl_records.shelf,\
   tbl_records.status,\
   tbl_records.qc_status,\
   tbl_records.assigned_to,\
   tbl_records.is_reviewed,\
   tbl_records.is_add,\
   tbl_records.duration_mins,\
   tbl_records.loc_code,\
   tbl_records.rec_status,\
   tbl_records.qc_cataloger_id,\
   UNIX_TIMESTAMP(tbl_records.updated_at) as updated_at,\
   UNIX_TIMESTAMP(tbl_records.created_at) as created_at,\
   GROUP_CONCAT(tbl_record_detail.thumb_url SEPARATOR ' | ' ) AS concat_image_path,\
   tbl_record_detail.filepath,\
   tbl_record_detail.filepath_thumb,\
   tbl_record_detail.thumb_url,\
   CONCAT(UPA.first_name, ' ', UPA.last_name) AS username,\
   CONCAT(UPC.first_name, ' ', UPC.last_name) AS assigned_qcr,\
   UNIX_TIMESTAMP(LR.created_at) AS failed_history,\
   UNIX_TIMESTAMP(LRFR.created_at) AS cataloged_date\
   FROM (`tbl_records`)\
   INNER JOIN `tbl_record_detail` ON `tbl_record_detail`.`record_id` = `tbl_records`.`id`\
   LEFT OUTER JOIN `user_profile` AS UPA ON `tbl_records`.`assigned_to` = `UPA`.`user_id`\
   LEFT OUTER JOIN `user_profile` AS UPC ON `tbl_records`.`qc_cataloger_id` = `UPC`.`user_id`\
   LEFT OUTER JOIN `tbl_logs` AS LR ON `LR`.`record_id` = `tbl_records`.`id` AND LR.`status`='reviewed' AND (LR.`description`='QC status is set as fail' OR LR.`description`='Record passed Quality Control (with fail)')\
   LEFT OUTER JOIN `tbl_logs` AS LRFR ON `LRFR`.`record_id` = `tbl_records`.`id` AND LRFR.`status`='ready_for_review' AND LRFR.`description`='record is updated for review'\
   LEFT OUTER JOIN `tbl_field_values` AS LRFV ON `LRFV`.`id` = `tbl_records`.`series_title`\
   WHERE `tbl_records`.`is_add` =  1\
   AND `tbl_records`.`client_id` =  '1'\
   AND `tbl_records`.`id`>=$start AND `tbl_records`.`id`<=$end \
   GROUP BY tbl_records.id \
  # sql_query= SELECT id,user_id,upload_id,media_type,program_title FROM tbl_records

 #sql_attr_uint = id
 sql_attr_uint = user_id
 sql_attr_uint = upload_id
 sql_attr_uint = photographer_id
 sql_field_string = unique_id
 sql_attr_uint = unique_id_source
 sql_attr_uint = format
 sql_attr_uint = media_type
 sql_attr_uint = series_title
 sql_field_string = series_title_str
 sql_field_string = program_title
 sql_field_string = tap_title
 sql_field_string = concat_image_path
 sql_attr_uint = cc
 sql_attr_uint = hd
 sql_attr_uint = sap
 sql_field_string = participants
 sql_attr_uint = generation
 sql_field_string = duration
 sql_attr_uint    = durationMins
 sql_attr_uint = capacity
 sql_field_string = air_date
 sql_field_string = record_date
 sql_field_string = note
 sql_attr_uint = sup_review
 sql_field_string = client_id
 sql_field_string = site
 sql_field_string = room
 sql_field_string = location
 sql_field_string = row
 sql_field_string = unit
 sql_field_string = shelf
 sql_field_string = status
 sql_field_string = qc_status
 sql_attr_uint = assigned_to
 sql_attr_uint = is_reviewed
 sql_attr_uint = qc_sts 
 sql_attr_uint = is_add
 sql_attr_uint = qc_cataloger_id
 sql_field_string = loc_code
 sql_attr_uint = rec_status
 sql_attr_uint = duration_mins
 sql_attr_uint = updated_at
 sql_attr_uint = created_at
 sql_field_string = filepath
 sql_field_string = filepath_thumb
 sql_field_string = thumb_url
 sql_field_string = username
 sql_field_string = assigned_qcr
 sql_attr_uint = failed_history
 sql_attr_uint = cataloged_date
 sql_field_string = system_id
}
source catalyst_fields_value_src
{
 type= mysql
 sql_host= localhost
 sql_user= catalyst
 sql_pass=xoho@123
 sql_db = catalyst
 sql_port= 3306 # optional, default is 3306
 sql_query_pre = SET NAMES utf8
 sql_query_pre = SET SESSION query_cache_type=OFF
 sql_query_range = SELECT MIN(id),MAX(id) FROM tbl_field_values
 sql_range_step = 1000

 sql_query=SELECT\
   tbl_field_values.id,\
   tbl_field_values.field_id,\
   tbl_field_values.field_value\
   FROM (`tbl_field_values`)\
   WHERE `tbl_field_values`.`id`>=$start AND `tbl_field_values`.`id`<=$end \
   
  # sql_query= SELECT id,user_id,upload_id,media_type,program_title FROM tbl_records

 #sql_attr_uint = id
 sql_attr_uint = field_id
 sql_field_string = field_value
 
}

index catalyst_records_list
{
 source     = catalyst_records_list_src
  path     = /var/lib/sphinx/catalyst_records_list_src
  docinfo     = extern
  charset_type   = sbcs
 }
index catalyst_fields_value
{
 source     = catalyst_fields_value_src
  path     = /var/lib/sphinx/catalyst_fields_value_src
  docinfo     = extern
  charset_type   = sbcs
 }
indexer
{
 mem_limit = 1000M
}


searchd
{
 listen = 9312
 listen = 3306:mysql41
 log  = /var/log/sphinx/searchd.log
 query_log   = /var/log/sphinx/query.log
 read_timeout  = 5
 max_children  = 30
 pid_file   = /var/run/sphinx/searchd.pid
 max_matches   = 1000
 seamless_rotate  = 1
 preopen_indexes  = 1
 unlink_old   = 1
}
